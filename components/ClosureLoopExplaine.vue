<template>
    <div class="closure-explainer">
      <h1>–ó–∞–º—ã–∫–∞–Ω–∏—è –≤ —Ü–∏–∫–ª–∞—Ö JavaScript</h1>
      <p class="intro">–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è —Å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–æ–π –∑–∞–º—ã–∫–∞–Ω–∏–π –≤ —Ü–∏–∫–ª–∞—Ö –∏ —Å–ø–æ—Å–æ–±–∞–º–∏ –µ—ë —Ä–µ—à–µ–Ω–∏—è</p>
  
      <div class="problem-section">
        <h2>–ü—Ä–æ–±–ª–µ–º–∞</h2>
        <div class="code-container">
          <pre class="code">const button = document.getElementById("button");
  
  for (var i = 0; i &lt; 3; i++) {
    button.addEventListener("click", function (e) {
      console.log(i);
    });
  }
  
  button.click();</pre>
        </div>
  
        <div class="question-block">
          <h3>–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å?</h3>
          <div class="answer" :class="{ 'revealed': showAnswer }">
            <div @click="showAnswer = !showAnswer" class="reveal-btn">
              {{ showAnswer ? '–°–∫—Ä—ã—Ç—å –æ—Ç–≤–µ—Ç' : '–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç' }}
            </div>
            <div v-if="showAnswer" class="answer-content">
              <p>–í –∫–æ–Ω—Å–æ–ª—å –≤—ã–≤–µ–¥–µ—Ç—Å—è:</p>
              <div class="console-output">
                <div>3</div>
                <div>3</div>
                <div>3</div>
              </div>
              <p>–ù–æ –ø–æ—á–µ–º—É –Ω–µ 0, 1, 2?</p>
            </div>
          </div>
        </div>
      </div>
  
      <div class="explanation-section">
        <h2>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ</h2>
        <p>–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –∑–∞–º—ã–∫–∞–Ω–∏—è –∏ –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π <code>var</code> –≤ JavaScript:</p>
  
        <div class="visualization">
          <div class="visualization-container">
            <div class="memory-model">
              <div class="memory-title">–ü–∞–º—è—Ç—å –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ü–∏–∫–ª–∞</div>
              <div class="memory-area">
                <div class="variable">
                  <div class="var-name">i (var)</div>
                  <div class="var-value">3</div>
                </div>
                <div class="closures">
                  <div class="closure-title">–ó–∞–º—ã–∫–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤</div>
                  <div class="closure" v-for="index in 3" :key="index">
                    <div class="closure-name">–û–±—Ä–∞–±–æ—Ç—á–∏–∫ {{ index }}</div>
                    <div class="closure-scope">
                      <div class="scope-arrow" :style="{ animationDelay: (index * 0.2) + 's' }"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
  
            <button @click="simulateClick" class="demo-button" :disabled="isAnimating">
              {{ isAnimating ? '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...' : '–°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–∫' }}
            </button>
  
            <div class="console-visualization" :class="{ 'logging': isAnimating }">
              <div class="console-title">Console</div>
              <div class="console-content">
                <div class="log-line" v-for="(log, index) in logs" :key="index">
                  {{ log }}
                </div>
              </div>
            </div>
          </div>
  
          <div class="explanation-points">
            <div class="point">
              <div class="point-number">1</div>
              <div class="point-content">
                <p><strong>–ü—Ä–æ–±–ª–µ–º–∞ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏:</strong> –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è <code>i</code>, –æ–±—ä—è–≤–ª–µ–Ω–Ω–∞—è —Å –ø–æ–º–æ—â—å—é <code>var</code>, –∏–º–µ–µ—Ç <strong>—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é</strong> –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏, –∞ –Ω–µ –±–ª–æ—á–Ω—É—é.</p>
              </div>
            </div>
            <div class="point">
              <div class="point-number">2</div>
              <div class="point-content">
                <p><strong>–ó–∞–º—ã–∫–∞–Ω–∏–µ:</strong> –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–∑–¥–∞–µ—Ç –∑–∞–º—ã–∫–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ "–∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç" –æ–∫—Ä—É–∂–µ–Ω–∏–µ, –≥–¥–µ –æ–Ω–∞ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞.</p>
              </div>
            </div>
            <div class="point">
              <div class="point-number">3</div>
              <div class="point-content">
                <p><strong>–û–±—â–∞—è —Å—Å—ã–ª–∫–∞:</strong> –í—Å–µ —Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é <code>i</code>.</p>
              </div>
            </div>
            <div class="point">
              <div class="point-number">4</div>
              <div class="point-content">
                <p><strong>–û—Ç–ª–æ–∂–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:</strong> –ö –º–æ–º–µ–Ω—Ç—É –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ —Ü–∏–∫–ª —É–∂–µ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è, –∏ <code>i</code> —Å—Ç–∞–ª–æ —Ä–∞–≤–Ω—ã–º 3 (—É—Å–ª–æ–≤–∏–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Ü–∏–∫–ª–∞ <code>i &lt; 3</code>).</p>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <div class="solutions-section">
        <h2>–†–µ—à–µ–Ω–∏—è</h2>
        <div class="tabs">
          <div
            v-for="(solution, index) in solutions"
            :key="solution.id"
            :class="['tab', { active: activeTab === index }]"
            @click="activeTab = index"
          >
            {{ solution.title }}
          </div>
        </div>
  
        <div class="solution-content">
          <h3>{{ solutions[activeTab].title }}</h3>
          <div class="code-container">
            <pre class="code">{{ solutions[activeTab].code }}</pre>
          </div>
          <div class="solution-explanation">
            <p v-html="solutions[activeTab].explanation"></p>
            <div class="solution-animation">
              <div class="animation-container">
                <div class="memory-model">
                  <div class="memory-title">–ü–∞–º—è—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º {{ solutions[activeTab].shortTitle }}</div>
                  <div class="memory-area">
                    <template v-if="activeTab === 0">
                      <!-- let -->
                      <div class="variables-array">
                        <div class="variable-in-iteration" v-for="j in 3" :key="j">
                          <div class="var-name">i (–±–ª–æ–∫ –∏—Ç–µ—Ä–∞—Ü–∏–∏ {{ j-1 }})</div>
                          <div class="var-value">{{ j-1 }}</div>
                        </div>
                      </div>
                      <div class="closures">
                        <div class="closure-title">–ó–∞–º—ã–∫–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤</div>
                        <div class="closure" v-for="j in 3" :key="j">
                          <div class="closure-name">–û–±—Ä–∞–±–æ—Ç—á–∏–∫ {{ j }}</div>
                          <div class="closure-scope">
                            <div class="scope-arrow-correct" :style="{ top: ((j-1) * 40) + 'px' }"></div>
                          </div>
                        </div>
                      </div>
                    </template>
                    <template v-else-if="activeTab === 1">
                      <!-- IIFE -->
                      <div class="variables-array">
                        <div class="variable-in-iteration" v-for="j in 3" :key="j">
                          <div class="var-name">localI (—Ñ—É–Ω–∫—Ü–∏—è {{ j }})</div>
                          <div class="var-value">{{ j-1 }}</div>
                        </div>
                      </div>
                      <div class="closures">
                        <div class="closure-title">–ó–∞–º—ã–∫–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤</div>
                        <div class="closure" v-for="j in 3" :key="j">
                          <div class="closure-name">–û–±—Ä–∞–±–æ—Ç—á–∏–∫ {{ j }}</div>
                          <div class="closure-scope">
                            <div class="scope-arrow-correct" :style="{ top: ((j-1) * 40) + 'px' }"></div>
                          </div>
                        </div>
                      </div>
                    </template>
                    <template v-else-if="activeTab === 2">
                      <!-- bind -->
                      <div class="variable">
                        <div class="var-name">i (var)</div>
                        <div class="var-value">3</div>
                      </div>
                      <div class="closures">
                        <div class="closure-title">–§—É–Ω–∫—Ü–∏–∏ —Å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏</div>
                        <div class="closure" v-for="j in 3" :key="j">
                          <div class="closure-name">–û–±—Ä–∞–±–æ—Ç—á–∏–∫ {{ j }}</div>
                          <div class="closure-bound-args">
                            <div class="bound-arg">
                              <div class="arg-name">–ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ</div>
                              <div class="arg-value">{{ j-1 }}</div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </template>
                    <template v-else>
                      <!-- data-attribute -->
                      <div class="variable">
                        <div class="var-name">i (var)</div>
                        <div class="var-value">3</div>
                      </div>
                      <div class="closures">
                        <div class="closure-title">DOM —ç–ª–µ–º–µ–Ω—Ç—ã —Å data-–∞—Ç—Ä–∏–±—É—Ç–∞–º–∏</div>
                        <div class="dom-element" v-for="j in 3" :key="j">
                          <div class="element-name">button</div>
                          <div class="element-attrs">
                            <div class="attr-name">data-index</div>
                            <div class="attr-value">{{ j-1 }}</div>
                          </div>
                        </div>
                      </div>
                    </template>
                  </div>
                </div>
  
                <button @click="simulateCorrectClick" class="demo-button" :disabled="isCorrectAnimating">
                  {{ isCorrectAnimating ? '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...' : '–°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–∫' }}
                </button>
  
                <div class="console-visualization" :class="{ 'logging': isCorrectAnimating }">
                  <div class="console-title">Console</div>
                  <div class="console-content">
                    <div class="log-line" v-for="(log, index) in correctLogs" :key="index">
                      {{ log }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <div class="real-world-section">
        <h2>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</h2>
        <div class="real-world-examples">
          <div class="example-card">
            <div class="example-title">–†–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö</div>
            <div class="example-content">
              <p>–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö, –≥–¥–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –∏–Ω–¥–µ–∫—Å –∏–ª–∏ ID —ç–ª–µ–º–µ–Ω—Ç–∞.</p>
              <div class="example-snippet">
                <pre class="code">// –ë–µ–∑ let –∏–ª–∏ –∑–∞–º—ã–∫–∞–Ω–∏–π - –ü–†–û–ë–õ–ï–ú–ê
  rows.forEach(function(row, index) {
    row.onclick = function() {
      console.log('–ù–∞–∂–∞—Ç–∞ —Å—Ç—Ä–æ–∫–∞:', index);
    };
  });</pre>
              </div>
            </div>
          </div>
          <div class="example-card">
            <div class="example-title">–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–∂–µ—Ç–æ–≤</div>
            <div class="example-content">
              <p>–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ UI (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–Ω–æ–ø–æ–∫ –≤ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤), –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å–≤–æ–∏–º –∏–Ω–¥–µ–∫—Å–æ–º.</p>
              <div class="example-snippet">
                <pre class="code">// –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Å let
  for (let i = 0; i &lt; 5; i++) {
    const button = document.createElement('button');
    button.textContent = `–û–ø—Ü–∏—è ${i}`;
    button.addEventListener('click', () => {
      applyOption(i);
    });
    toolbar.appendChild(button);
  }</pre>
              </div>
            </div>
          </div>
          <div class="example-card">
            <div class="example-title">–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ü–∏–∫–ª–µ</div>
            <div class="example-content">
              <p>–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å <code>setTimeout</code>, AJAX-–∑–∞–ø—Ä–æ—Å–∞–º–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–º–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –≤–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–∞.</p>
              <div class="example-snippet">
                <pre class="code">// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π - —Å –ø–æ–º–æ—â—å—é IIFE
  for (var i = 0; i &lt; urls.length; i++) {
    (function(index) {
      setTimeout(() => {
        fetch(urls[index])
          .then(resp => resp.json())
          .then(data => {
            console.log(`–î–∞–Ω–Ω—ã–µ ${index}:`, data);
          });
      }, index * 1000);
    })(i);
  }</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <div class="summary-section">
        <h2>–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</h2>
        <div class="summary-points">
          <div class="summary-point">
            <div class="point-icon">üí°</div>
            <div class="point-text">
              <strong>–ü–æ–Ω–∏–º–∞–π—Ç–µ –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏</strong>: <code>var</code> –∏–º–µ–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏, <code>let</code> –∏ <code>const</code> ‚Äî –±–ª–æ—á–Ω—É—é.
            </div>
          </div>
          <div class="summary-point">
            <div class="point-icon">üîÑ</div>
            <div class="point-text">
              <strong>–ó–∞–º—ã–∫–∞–Ω–∏—è "–∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç" –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∞ –Ω–µ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è</strong>: –æ–Ω–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∞ –Ω–µ –µ—ë –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è.
            </div>
          </div>
          <div class="summary-point">
            <div class="point-icon">‚è≤Ô∏è</div>
            <div class="point-text">
              <strong>–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ–∑–∂–µ</strong>: –∫ –º–æ–º–µ–Ω—Ç—É –∏—Ö –≤—ã–∑–æ–≤–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª–∞ —É–∂–µ –º–æ–≥—É—Ç –∏–º–µ—Ç—å –¥—Ä—É–≥–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è.
            </div>
          </div>
          <div class="summary-point">
            <div class="point-icon">‚úÖ</div>
            <div class="point-text">
              <strong>–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ</strong>: –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤, —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –∏ —á–∏—Å—Ç—ã–π —Å–ø–æ—Å–æ–± ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <code>let</code> –≤–º–µ—Å—Ç–æ <code>var</code>.
            </div>
          </div>
        </div>
      </div>
    </div>
  </template>
  
  <script>
  export default {
    name: 'ClosureLoopExplainer',
    data() {
      return {
        showAnswer: false,
        activeTab: 0,
        isAnimating: false,
        isCorrectAnimating: false,
        logs: [],
        correctLogs: [],
        solutions: [
          {
            id: 'let',
            title: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å let –≤–º–µ—Å—Ç–æ var',
            shortTitle: 'let',
            code: `const button = document.getElementById("button");
  
  for (let i = 0; i < 3; i++) {
    button.addEventListener("click", function (e) {
      console.log(i);
    });
  }
  
  button.click();`,
            explanation: '<strong>–†–µ—à–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º <code>let</code></strong>: –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç <code>var</code>, –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è <code>let</code> –∏–º–µ–µ—Ç –±–ª–æ—á–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ü–∏–∫–ª–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è <em>–Ω–æ–≤–∞—è</em> –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è <code>i</code>. –ö–∞–∂–¥–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é <code>i</code> —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.'
          },
          {
            id: 'iife',
            title: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IIFE',
            shortTitle: 'IIFE',
            code: `const button = document.getElementById("button");
  
  for (var i = 0; i < 3; i++) {
    (function(localI) {
      button.addEventListener("click", function (e) {
        console.log(localI);
      });
    })(i);
  }
  
  button.click();`,
            explanation: '<strong>–†–µ—à–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º IIFE</strong> (Immediately Invoked Function Expression): –ú—ã —Å–æ–∑–¥–∞–µ–º –∏ —Å—Ä–∞–∑—É –∂–µ –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –ø–µ—Ä–µ–¥–∞–≤–∞—è —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ <code>i</code> –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç. –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π <code>localI</code>, –∫–æ—Ç–æ—Ä–∞—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ <code>i</code> –Ω–∞ –º–æ–º–µ–Ω—Ç –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏.'
          },
          {
            id: 'bind',
            title: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å bind()',
            shortTitle: 'bind()',
            code: `const button = document.getElementById("button");
  
  for (var i = 0; i < 3; i++) {
    button.addEventListener("click", function (index, e) {
      console.log(index);
    }.bind(null, i));
  }
  
  button.click();`,
            explanation: '<strong>–†–µ—à–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º <code>bind()</code></strong>: –ú–µ—Ç–æ–¥ <code>bind()</code> —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é —Å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏. –ú—ã –ø–µ—Ä–µ–¥–∞–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ <code>i</code> –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –≤ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ü–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä <code>null</code> ‚Äî —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ <code>this</code>, –∫–æ—Ç–æ—Ä–æ–µ –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –Ω–µ –≤–∞–∂–Ω–æ.'
          },
          {
            id: 'data-attr',
            title: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å data-–∞—Ç—Ä–∏–±—É—Ç—ã',
            shortTitle: 'data-–∞—Ç—Ä–∏–±—É—Ç—ã',
            code: `const button = document.getElementById("button");
  
  for (var i = 0; i < 3; i++) {
    const btn = button.cloneNode(true);
    btn.setAttribute('data-index', i);
    btn.addEventListener("click", function (e) {
      const index = parseInt(e.target.getAttribute('data-index'));
      console.log(index);
    });
    button.parentNode.appendChild(btn);
  }
  
  // –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —ç—Ç–æ—Ç –∫–æ–¥ —Å–æ–∑–¥–∞—Å—Ç –∫–ª–æ–Ω—ã –∫–Ω–æ–ø–∫–∏
  // –í —Ä–µ–∞–ª—å–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤—ã –±—ã —Ä–∞–±–æ—Ç–∞–ª–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏`,
            explanation: '<strong>–†–µ—à–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º data-–∞—Ç—Ä–∏–±—É—Ç–æ–≤</strong>: –ú—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ <code>i</code> –∫–∞–∫ –∞—Ç—Ä–∏–±—É—Ç DOM-—ç–ª–µ–º–µ–Ω—Ç–∞ (<code>data-index</code>), –∞ –∑–∞—Ç–µ–º –ø–æ–ª—É—á–∞–µ–º –µ–≥–æ –∏–∑ —Å–æ–±—ã—Ç–∏—è. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∏ —Ö–æ—Ç–∏—Ç–µ —Å–≤—è–∑–∞—Ç—å —Å –Ω–∏–º–∏ –∫–∞–∫–∏–µ-—Ç–æ –¥–∞–Ω–Ω—ã–µ.'
          }
        ]
      };
    },
    methods: {
      simulateClick() {
        if (this.isAnimating) return;
        
        this.isAnimating = true;
        this.logs = [];
        
        // –°–∏–º—É–ª–∏—Ä—É–µ–º –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
        setTimeout(() => {
          this.logs.push('3');
          
          setTimeout(() => {
            this.logs.push('3');
            
            setTimeout(() => {
              this.logs.push('3');
              
              setTimeout(() => {
                this.isAnimating = false;
              }, 500);
            }, 300);
          }, 300);
        }, 500);
      },
      simulateCorrectClick() {
        if (this.isCorrectAnimating) return;
        
        this.isCorrectAnimating = true;
        this.correctLogs = [];
        
        // –°–∏–º—É–ª–∏—Ä—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ (0, 1, 2)
        setTimeout(() => {
          this.correctLogs.push('0');
          
          setTimeout(() => {
            this.correctLogs.push('1');
            
            setTimeout(() => {
              this.correctLogs.push('2');
              
              setTimeout(() => {
                this.isCorrectAnimating = false;
              }, 500);
            }, 300);
          }, 300);
        }, 500);
      }
    }
  };
  </script>
  
  <style scoped>
  .closure-explainer {
    max-width: 1000px;
    margin: 0 auto;
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    color: #333;
    background-color: #fff;
    line-height: 1.6;
  }
  
  h1 {
    text-align: center;
    color: #333;
    margin-bottom: 10px;
    font-size: 2.2rem;
  }
  
  .intro {
    text-align: center;
    color: #666;
    margin-bottom: 30px;
    font-size: 1.1rem;
  }
  
  h2 {
    color: #333;
    border-bottom: 2px solid #4F46E5;
    padding-bottom: 8px;
    margin-top: 40px;
    margin-bottom: 20px;
  }
  
  h3 {
    color: #333;
    margin-top: 25px;
    margin-bottom: 15px;
  }
  
  code {
    background-color: #f0f0f0;
    padding: 2px 5px;
    border-radius: 3px;
    font-family: Consolas, Monaco, 'Andale Mono', monospace;
    color: #d32f2f;
  }
  
  .code-container {
    background-color: #282c34;
    border-radius: 8px;
    margin: 15px 0;
    overflow: hidden;
  }
  
  .code {
    padding: 15px;
    color: #abb2bf;
    font-family: Consolas, Monaco, 'Andale Mono', monospace;
    font-size: 14px;
    line-height: 1.5;
    margin: 0;
    white-space: pre;
    overflow-x: auto;
  }
  
  .question-block {
    background-color: #f5f5f5;
    border-left: 4px solid #4F46E5;
    padding: 15px;
    border-radius: 0 8px 8px 0;
    margin: 20px 0;
  }
  
  .answer {
    margin-top: 10px;
  }
  
  .reveal-btn {
    display: inline-block;
    background-color: #4F46E5;
    color: white;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.3s;
  }
  
  .reveal-btn:hover {
    background-color: #3c35b5;
  }
  
  .answer-content {
    margin-top: 15px;
    animation: fadeIn 0.5s;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  .console-output {
    background-color: #282c34;
    color: #abb2bf;
    padding: 10px 15px;
    border-radius: 4px;
    font-family: Consolas, Monaco, 'Andale Mono', monospace;
    margin: 10px 0;
  }
  
  /* Visualization styles */
  .visualization {
    margin: 30px 0;
  }
  
  .visualization-container {
    display: flex;
    flex-direction: column;
    gap: 20px;
    background-color: #f5f5f5;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
  }
  
  .memory-model {
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    background-color: white;
  }
  
  .memory-title {
    background-color: #4F46E5;
    color: white;
    padding: 10px;
    font-weight: 500;
  }
  
  .memory-area {
    padding: 20px;
    display: flex;
    align-items: flex-start;
    gap: 40px;
  }
  
  .variable {
    border: 1px solid #ddd;
    border-radius: 6px;
    overflow: hidden;
    width: 150px;
  }
  
  .var-name {
    background-color: #f0f0f0;
    padding: 8px 10px;
    font-weight: 500;
    font-family: Consolas, Monaco, monospace;
    font-size: 14px;
    border-bottom: 1px solid #ddd;
  }
  
  .var-value {
    padding: 8px 10px;
    font-family: Consolas, Monaco, monospace;
    font-size: 16px;
    color: #d32f2f;
    text-align: center;
  }
  
  .closures {
    flex: 1;
  }
  
  .closure-title {
    margin-bottom: 10px;
    font-weight: 500;
  }
  
  .closure {
    border: 1px solid #ddd;
    border-radius: 6px;
    margin-bottom: 10px;
    overflow: hidden;
    display: flex;
    height: 40px;
  }
  
  .closure-name {
    background-color: #f0f0f0;
    padding: 8px 10px;
    font-weight: 500;
    width: 150px;
    border-right: 1px solid #ddd;
  }
  
  .closure-scope {
    flex: 1;
    position: relative;
  }
  
  .scope-arrow {
    position: absolute;
    left: 0;
    top: 50%;
    width: 80%;
    height: 2px;
    background-color: #d32f2f;
    transform: translateY(-50%);
  }
  
  .scope-arrow::after {
    content: '';
    position: absolute;
    right: 0;
    top: -4px;
    width: 0;
    height: 0;
    border-top: 5px solid transparent;
    border-bottom: 5px solid transparent;
    border-left: 8px solid #d32f2f;
  }
  
  .scope-arrow {
    animation: arrowPulse 2s infinite;
  }
  
  @keyframes arrowPulse {
    0% { opacity: 0.5; }
    50% { opacity: 1; }
    100% { opacity: 0.5; }
  }
  
  /* –ü–†–ê–í–ò–õ–¨–ù–´–ï –†–ï–®–ï–ù–ò–Ø */
  .variables-array {
    display: flex;
    flex-direction: column;
    gap: 10px;
    width: 200px;
  }
  
  .variable-in-iteration {
    border: 1px solid #ddd;
    border-radius: 6px;
    overflow: hidden;
  }
  
  .scope-arrow-correct {
    position: absolute;
    left: 0;
    width: 80%;
    height: 2px;
    background-color: #4caf50;
    transform: translateY(-50%);
  }
  
  .scope-arrow-correct::after {
    content: '';
    position: absolute;
    right: 0;
    top: -4px;
    width: 0;
    height: 0;
    border-top: 5px solid transparent;
    border-bottom: 5px solid transparent;
    border-left: 8px solid #4caf50;
  }
  
  .closure-bound-args {
    flex: 1;
    padding: 8px 10px;
    display: flex;
    align-items: center;
  }
  
  .bound-arg {
    border: 1px solid #4caf50;
    border-radius: 4px;
    overflow: hidden;
    display: flex;
    align-items: center;
  }
  
  .arg-name {
    background-color: #e8f5e9;
    padding: 2px 6px;
    font-size: 12px;
    border-right: 1px solid #4caf50;
  }
  
  .arg-value {
    padding: 2px 8px;
    color: #4caf50;
    font-weight: 500;
  }
  
  .dom-element {
    border: 1px solid #ff9800;
    border-radius: 6px;
    margin-bottom: 10px;
    overflow: hidden;
    display: flex;
    height: 40px;
  }
  
  .element-name {
    background-color: #fff3e0;
    padding: 8px 10px;
    font-weight: 500;
    width: 120px;
    border-right: 1px solid #ffcc80;
  }
  
  .element-attrs {
    display: flex;
    flex: 1;
    align-items: center;
  }
  
  .attr-name {
    background-color: #fff8e1;
    padding: 2px 8px;
    margin-left: 10px;
    font-family: Consolas, Monaco, monospace;
    font-size: 12px;
    border-radius: 4px 0 0 4px;
    border: 1px solid #ffcc80;
    border-right: none;
  }
  
  .attr-value {
    background-color: white;
    padding: 2px 8px;
    font-family: Consolas, Monaco, monospace;
    font-size: 12px;
    color: #e65100;
    border-radius: 0 4px 4px 0;
    border: 1px solid #ffcc80;
    border-left: none;
  }
  
  .demo-button {
    background-color: #4F46E5;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
    font-size: 16px;
    align-self: center;
    transition: background-color 0.3s;
  }
  
  .demo-button:hover:not(:disabled) {
    background-color: #3c35b5;
  }
  
  .demo-button:disabled {
    background-color: #9ca3af;
    cursor: not-allowed;
  }
  
  .console-visualization {
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    background-color: white;
  }
  
  .console-title {
    background-color: #282c34;
    color: white;
    padding: 8px 10px;
    font-family: Consolas, Monaco, monospace;
  }
  
  .console-content {
    background-color: #282c34;
    color: #abb2bf;
    padding: 10px;
    min-height: 100px;
    font-family: Consolas, Monaco, monospace;
  }
  
  .console-visualization.logging .console-content {
    animation: blinkConsole 1s;
  }
  
  @keyframes blinkConsole {
    0% { background-color: #282c34; }
    50% { background-color: #3e4451; }
    100% { background-color: #282c34; }
  }
  
  .log-line {
    margin-bottom: 5px;
    animation: slideFadeIn 0.3s;
  }
  
  @keyframes slideFadeIn {
    from {
      opacity: 0;
      transform: translateY(-5px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Explanation points */
  .explanation-points {
    margin-top: 30px;
  }
  
  .point {
    display: flex;
    align-items: flex-start;
    margin-bottom: 15px;
  }
  
  .point-number {
    width: 28px;
    height: 28px;
    background-color: #4F46E5;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    margin-right: 15px;
    flex-shrink: 0;
  }
  
  .point-content {
    flex: 1;
  }
  
  .point-content p {
    margin: 0;
  }
  
  /* Solutions tabs */
  .tabs {
    display: flex;
    margin-bottom: 20px;
    border-bottom: 1px solid #e5e7eb;
    gap: 10px;
  }
  
  .tab {
    padding: 10px 15px;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    transition: all 0.3s;
  }
  
  .tab:hover {
    background-color: #f9fafb;
  }
  
  .tab.active {
    border-bottom-color: #4F46E5;
    color: #4F46E5;
    font-weight: 500;
  }
  
  .solution-content {
    animation: fadeIn 0.5s;
  }
  
  .solution-explanation {
    margin: 20px 0;
    line-height: 1.7;
  }
  
  .solution-animation {
    margin-top: 30px;
  }
  
  .animation-container {
    display: flex;
    flex-direction: column;
    gap: 20px;
    background-color: #f5f5f5;
    padding: 20px;
    border-radius: 8px;
  }
  
  /* Real world examples */
  .real-world-examples {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 20px;
  }
  
  .example-card {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    overflow: hidden;
    background-color: white;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s, box-shadow 0.3s;
  }
  
  .example-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
  }
  
  .example-title {
    background-color: #4F46E5;
    color: white;
    padding: 12px 15px;
    font-weight: 500;
    font-size: 1.1rem;
  }
  
  .example-content {
    padding: 15px;
  }
  
  .example-snippet {
    margin-top: 10px;
  }
  
  .example-snippet .code {
    font-size: 12px;
    max-height: 150px;
    overflow-y: auto;
  }
  
  /* Summary section */
  .summary-points {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 20px;
  }
  
  .summary-point {
    display: flex;
    align-items: flex-start;
    background-color: #f8fafc;
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
  }
  
  .point-icon {
    font-size: 24px;
    margin-right: 15px;
  }
  
  .point-text {
    flex: 1;
  }
  
  /* Responsive adjustments */
  @media (max-width: 768px) {
    .memory-area {
      flex-direction: column;
      align-items: center;
    }
    
    .real-world-examples,
    .summary-points {
      grid-template-columns: 1fr;
    }
    
    .solution-animation .memory-area {
      flex-direction: column;
      align-items: center;
    }
    
    .variables-array {
      width: 100%;
      max-width: 300px;
    }
    
    .point {
      flex-direction: column;
      align-items: flex-start;
    }
    
    .point-number {
      margin-bottom: 10px;
    }
  }
  </style>